{% extends "restaurant/base.html" %}
{% load static %}

{% block title %}Menu{% endblock %}

{% block content %}
    <main class='container'>
        <div class='container heading'>
            <h1>Our Menu</h1>
            <h3>Add items to your order!</h3>
        </div>
        <form class='container form' action="{% url 'order-review' %}" method='post'>
            {% csrf_token %}
            <div class='container review-button'>
                <button type="submit" class='button'>Review order</button>
            </div>
            <label for="order-type">Select your order type:</label>
                    <select id="order-type" name="order-type">
                        <option value="I">Dine In</option>
                        <option value="P">Pickup</option>
                        <option value="D">Delivery</option>
                    </select>
            <div class='container menu'>
                {% for item in menu %}
                    {% if item.is_available %}
                        <div class='container card' id="dish-{{ item.id }}">
                            <img class='dish-img' src="{% static 'restaurant/images/dishes/dish'|add:item.id|add:'.png' %}" alt="{{ item.desc }}">
                            <h3 class='dish-name'>{{ item.name }}</h3>
                            <p class='dish-desc'>{{ item.desc }}</p>
                            {% if item.allergen != 'NA' %}   
                                <img class='allergen-icon' src="{% static 'restaurant/images/allergens/'|add:item.allergen|add:'.png' %}" alt="{{ item.get_allergen_display }}">
                            {% endif %}
                            <p class='dish-ingredients'><em>{{ item.ingredients }}</em></p>
                            <div class="container add-remove-quantity">
                                <p class='button sub-button'>-</p>
                                <input class='qty-input' type="number" id="{{ item.html_name }}" name="{{ item.html_name }}" min="0" value="{{ item.quantity|default:"0" }}">
                                <p class='button add-button'>+</p>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class='container review-button'>
                <button type="submit" class='button'>Review order</button>
            </div>
        </form>
        {% comment %}Older iteration that did not utilise form logic.
            
            <div class='container menu-container'>
                {% for item in menu %}
                    {% if item.is_available %}
                        <div class='container card' id="dish-{{ item.id }}">
                            <img class='dish-img' src="{% static 'restaurant/images/dishes/dish'|add:item.id|add:'.png' %}" alt="{{ item.desc }}">
                            <h3 class='dish-name'>{{ item.name }}</h3>
                            <p class='dish-desc'>{{ item.desc }}</p>
                            {% if item.allergen != 'NA' %}   
                                <img class='allergen-icon' src="{% static 'restaurant/images/allergens/'|add:item.allergen|add:'.png' %}" alt="{{ item.get_allergen_display }}">
                            {% endif %}
                            <p class='dish-ingrdients'><em>{{ dish.ingredients }}</em></p>
                            <div class="container add-remove-quantity">
                                <p class='button'><a href="{% url 'remove-item' item.id %}">-</a></p>
                                <input type="number" class='quantity' name="quantity" min=0 value={{ item.quantity|default:0 }}>
                                <p class='button'><a href="{% url 'add-item' item.id %}">+</a></p>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
            {% if order.total %}
                <div class='container'>
                    <p class='total'>Total order: {{ order.total }}</p>
                </div>
                <div class='container'>
                    <a href="{% url 'order-review' order.id|default:0 %}"><p>Review and place order</p></a>
                </div>
        {% endcomment %}
    </main>
{% endblock %}